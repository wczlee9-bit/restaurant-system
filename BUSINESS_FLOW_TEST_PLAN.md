# 餐饮系统端到端业务流程测试方案

## 目标
从6个业务角色的角度，完整测试整个餐饮系统的业务流程。

---

## 测试流程概览

```
客户点餐 → 厨师做菜 → 传菜员传菜 → 收款员收款 → 店铺管理 → 财务统计
   ↓          ↓           ↓            ↓            ↓           ↓
  测试1      测试2        测试3         测试4        测试5       测试6
```

---

## 详细测试步骤

### 📱 测试1：客户点餐流程

**角色**：客户
**场景**：从扫码到付款的完整流程

#### 步骤1.1：扫描二维码进入点餐页面
- 操作：客户扫描桌号二维码
- 预期：自动识别桌号，进入点餐页面
- 测试URL：`http://localhost:8888/customer_order_v3_fixed.html?table_id=55`

#### 步骤1.2：浏览菜品
- 操作：查看不同分类的菜品
- 预期：显示5个分类（热菜、凉菜、主食、饮品、汤品）
- 预期：显示菜品图片、价格、库存

#### 步骤1.3：点餐
- 操作：选择菜品，调整数量
- 预期：购物车实时更新
- 预期：显示菜品数量和总价

#### 步骤1.4：创建订单
- 操作：确认订单，点击"下单"
- 预期：订单创建成功
- 预期：订单状态为"pending"（待制作）

#### 步骤1.5：等待制作
- 操作：查看订单状态
- 预期：订单状态从"pending" → "confirmed" → "preparing"

#### 步骤1.6：用餐
- 操作：菜品上桌，客户用餐
- 预期：订单状态为"ready"（可传菜）→ "serving"（上菜中）

#### 步骤1.7：付款
- 操作：选择支付方式，确认付款
- 预期：订单状态为"paid"（已付款）

---

### 👨‍🍳 测试2：厨师做菜流程

**角色**：厨师
**场景**：接收订单，制作菜品，出菜

#### 步骤2.1：查看待制作订单
- 操作：打开厨房看板
- 预期：显示所有"pending"或"confirmed"状态的订单
- 测试URL：`http://localhost:8888/kitchen_display.html`

#### 步骤2.2：接收订单
- 操作：厨师点击"接收"按钮
- 预期：订单状态更新为"preparing"（制作中）
- API：`PUT /api/orders/{id}/status {"status": "preparing"}`

#### 步骤2.3：开始制作单品
- 操作：选择菜品，点击"开始制作"
- 预期：菜品状态更新为"preparing"
- API：`PUT /api/order-items/{id}/status {"status": "preparing"}`

#### 步骤2.4：完成单品
- 操作：菜品制作完成，点击"完成"
- 预期：菜品状态更新为"ready"
- API：`PUT /api/order-items/{id}/status {"status": "ready"}`

#### 步骤2.5：订单全部完成
- 操作：所有菜品都完成
- 预期：订单状态更新为"ready"（可传菜）

---

### 🚶 测试3：传菜员流程

**角色**：传菜员
**场景**：接收已完成的菜品，传送到餐桌

#### 步骤3.1：查看待传菜订单
- 操作：打开传菜看板
- 预期：显示所有"ready"状态的订单
- 测试URL：`http://localhost:8888/staff_workflow.html`

#### 步骤3.2：确认传菜
- 操作：点击"开始传菜"
- 预期：订单状态更新为"serving"（传菜中）
- API：`PUT /api/orders/{id}/status {"status": "serving"}`

#### 步骤3.3：传菜完成
- 操作：菜品传送到餐桌
- 预期：订单状态更新为"completed"（已完成）
- API：`PUT /api/orders/{id}/status {"status": "completed"}`

---

### 💰 测试4：收款员流程

**角色**：收款员
**场景**：查看订单，确认收款

#### 步骤4.1：查看待收款订单
- 操作：打开收款页面
- 预期：显示所有"completed"但未付款的订单
- 测试URL：`http://localhost:8888/settlement_management.html`

#### 步骤4.2：确认收款
- 操作：选择订单，选择支付方式
- 预期：订单支付状态更新为"paid"
- API：`POST /api/orders/{id}/confirm-payment {"payment_method": "cash"}`

#### 步骤4.3：打印小票（可选）
- 操作：点击"打印小票"
- 预期：生成小票信息

---

### ⚙️ 测试5：店铺设置流程

**角色**：店长/管理员
**场景**：设置菜品、价格、桌号、二维码

#### 步骤5.1：新增菜品
- 操作：进入菜品管理页面
- 预期：显示菜品列表
- 测试URL：`http://localhost:8888/menu_management.html`

#### 步骤5.2：添加新菜品
- 操作：点击"添加菜品"，填写信息
- 预期：菜品创建成功
- API：`POST /api/menu-items/`

#### 步骤5.3：修改价格
- 操作：编辑菜品价格
- 预期：价格更新成功
- API：`PUT /api/menu-items/{id}`

#### 步骤5.4：管理桌号
- 操作：进入桌号管理
- 预期：显示所有桌号
- API：`GET /api/tables/`

#### 步骤5.5：添加桌号
- 操作：点击"添加桌号"
- 预期：桌号创建成功
- API：`POST /api/tables/`

#### 步骤5.6：生成二维码
- 操作：点击"生成二维码"
- 预期：生成二维码图片
- API：`POST /api/tables/{id}/generate-qr`

---

### 📊 测试6：财务统计流程

**角色**：财务人员/店长
**场景**：查看营业数据，生成报表

#### 步骤6.1：查看今日营业额
- 操作：进入财务统计页面
- 预期：显示今日营业额
- API：`GET /api/stats/daily`

#### 步骤6.2：查看桌次统计
- 操作：查看翻台率
- 预期：显示每个桌号的使用次数
- API：`GET /api/stats/tables`

#### 步骤6.3：查看菜品销售统计
- 操作：查看热销菜品
- 预期：显示菜品销量排名
- API：`GET /api/stats/menu-sales`

#### 步骤6.4：查看库存统计
- 操作：查看库存情况
- 预期：显示菜品库存
- API：`GET /api/stats/inventory`

#### 步骤6.5：生成收入报表
- 操作：选择日期范围，生成报表
- 预期：显示收入明细
- API：`GET /api/revenue/`

---

## 测试数据准备

### 测试桌号
- 8号桌（ID: 55）- 4座
- T01桌（ID: 11）- 4座
- T02桌（ID: 12）- 4座

### 测试菜品
- 鱼香肉丝（ID: 2）- ¥32 - 热菜
- 麻婆豆腐（ID: 3）- ¥28 - 热菜
- 可乐（ID: 5）- ¥6 - 饮品
- 蛋炒饭（ID: 6）- ¥16 - 主食

### 测试支付方式
- 现金（cash）
- 支付宝（alipay）
- 微信支付（wechat）
- 银行卡（card）

---

## 测试结果记录模板

| 测试步骤 | 测试时间 | 测试人员 | 结果 | 问题描述 |
|---------|---------|---------|------|---------|
| 测试1.1 | | | ☐通过 ☐失败 | |
| 测试1.2 | | | ☐通过 ☐失败 | |
| 测试1.3 | | | ☐通过 ☐失败 | |
| 测试1.4 | | | ☐通过 ☐失败 | |
| 测试1.5 | | | ☐通过 ☐失败 | |
| 测试1.6 | | | ☐通过 ☐失败 | |
| 测试1.7 | | | ☐通过 ☐失败 | |
| 测试2.1 | | | ☐通过 ☐失败 | |
| 测试2.2 | | | ☐通过 ☐失败 | |
| 测试2.3 | | | ☐通过 ☐失败 | |
| 测试2.4 | | | ☐通过 ☐失败 | |
| 测试2.5 | | | ☐通过 ☐失败 | |
| 测试3.1 | | | ☐通过 ☐失败 | |
| 测试3.2 | | | ☐通过 ☐失败 | |
| 测试3.3 | | | ☐通过 ☐失败 | |
| 测试4.1 | | | ☐通过 ☐失败 | |
| 测试4.2 | | | ☐通过 ☐失败 | |
| 测试4.3 | | | ☐通过 ☐失败 | |
| 测试5.1 | | | ☐通过 ☐失败 | |
| 测试5.2 | | | ☐通过 ☐失败 | |
| 测试5.3 | | | ☐通过 ☐失败 | |
| 测试5.4 | | | ☐通过 ☐失败 | |
| 测试5.5 | | | ☐通过 ☐失败 | |
| 测试5.6 | | | ☐通过 ☐失败 | |
| 测试6.1 | | | ☐通过 ☐失败 | |
| 测试6.2 | | | ☐通过 ☐失败 | |
| 测试6.3 | | | ☐通过 ☐失败 | |
| 测试6.4 | | | ☐通过 ☐失败 | |
| 测试6.5 | | | ☐通过 ☐失败 | |

---

## 下一步行动

1. ✅ 创建业务流程测试方案（已完成）
2. ⏳ 补充缺失的API接口
3. ⏳ 创建自动化测试脚本
4. ⏳ 逐项测试各个流程
5. ⏳ 记录测试结果
6. ⏳ 修复发现的问题

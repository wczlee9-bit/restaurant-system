# 餐饮系统测试清单

## 测试前准备

### 环境检查
- [ ] Python 3.10+ 已安装
- [ ] PostgreSQL 14+ 已安装并运行
- [ ] 后端服务已启动（端口 8000）
- [ ] 前端文件已部署（`assets/customer_order_v3_fixed.html`）

### 启动后端服务
```bash
cd /workspace/projects
source venv/bin/activate
uvicorn src.api.restaurant_api:app --host 0.0.0.0 --port 8000
```

---

## 测试项目清单

### 第1部分：后端API基础功能测试

#### 1.1 健康检查
```bash
curl http://127.0.0.1:8000/health
```
**预期结果**：
- 状态码：200
- 返回 `{"status": "ok", "message": "餐饮系统API服务运行正常", ...}`

**测试结果**：□ 通过 □ 失败

#### 1.2 获取店铺信息
```bash
curl http://127.0.0.1:8000/api/store
```
**预期结果**：
- 状态码：200
- 返回店铺信息（名称、地址、电话、营业时间）

**测试结果**：□ 通过 □ 失败

#### 1.3 获取桌号列表
```bash
curl http://127.0.0.1:8000/api/tables/
```
**预期结果**：
- 状态码：200
- 返回桌号数组，包含 id、table_number、seats、is_occupied

**测试结果**：□ 通过 □ 失败

#### 1.4 获取菜品分类
```bash
curl http://127.0.0.1:8000/api/menu-categories/
```
**预期结果**：
- 状态码：200
- 返回分类数组（热菜、凉菜、主食、饮品、汤品）

**测试结果**：□ 通过 □ 失败

#### 1.5 获取菜品列表
```bash
curl http://127.0.0.1:8000/api/menu-items/
```
**预期结果**：
- 状态码：200
- 返回菜品数组，包含价格、库存、分类信息

**测试结果**：□ 通过 □ 失败

#### 1.6 获取订单列表
```bash
curl http://127.0.0.1:8000/api/orders/
```
**预期结果**：
- 状态码：200
- 返回订单数组，包含订单号、桌号、金额、状态

**测试结果**：□ 通过 □ 失败

---

### 第2部分：订单流程测试

#### 2.1 创建订单
```bash
curl -X POST http://127.0.0.1:8000/api/orders/ \
  -H "Content-Type: application/json" \
  -d '{
    "table_id": 55,
    "items": [
      {"menu_item_id": 2, "quantity": 1, "special_instructions": ""},
      {"menu_item_id": 3, "quantity": 1, "special_instructions": ""}
    ]
  }'
```
**预期结果**：
- 状态码：200
- 返回新订单信息，包含订单号、总金额

**测试结果**：□ 通过 □ 失败
**订单号**：_____________

#### 2.2 获取订单详情
```bash
curl http://127.0.0.1:8000/api/orders/{订单ID}
```
**预期结果**：
- 状态码：200
- 返回完整订单信息（订单项、状态、金额）

**测试结果**：□ 通过 □ 失败

#### 2.3 确认支付
```bash
curl -X POST http://127.0.0.1:8000/api/orders/{订单ID}/confirm-payment \
  -H "Content-Type: application/json" \
  -d '{"payment_method": "counter"}'
```
**预期结果**：
- 状态码：200
- 返回成功消息

**测试结果**：□ 通过 □ 失败

---

### 第3部分：前端页面测试

#### 3.1 页面加载
1. 在浏览器中打开前端页面（假设部署在 http://localhost:8080）
2. 检查页面是否正常显示

**预期结果**：
- 页面正常加载，显示"🍽️ 餐饮点餐系统"
- 显示店铺信息
- 显示桌号选择界面

**测试结果**：□ 通过 □ 失败

#### 3.2 桌号选择
1. 点击任意一个桌号（如"8号桌"）
2. 观察是否进入点餐界面

**预期结果**：
- 桌号被选中（高亮显示）
- 自动进入菜品点餐界面
- 显示菜品分类和菜品列表

**测试结果**：□ 通过 □ 失败

#### 3.3 分类切换
1. 点击不同的分类标签（热菜、凉菜、主食等）
2. 观察菜品列表是否切换

**预期结果**：
- 分类标签高亮显示
- 菜品列表正确切换

**测试结果**：□ 通过 □ 失败

#### 3.4 点餐功能
1. 点击菜品的"+"按钮增加数量
2. 点击"-"按钮减少数量
3. 观察购物车信息是否更新

**预期结果**：
- 菜品数量正确更新
- 购物车显示正确的商品数量和总价

**测试结果**：□ 通过 □ 失败

#### 3.5 创建订单
1. 选择至少一个菜品（数量大于0）
2. 点击底部购物车栏
3. 在订单确认页面点击"确认下单"

**预期结果**：
- 弹出订单确认弹窗
- 显示订单详情（菜品、数量、总价）
- 点击确认后显示"订单创建成功"提示

**测试结果**：□ 通过 □ 失败
**订单号**：_____________

#### 3.6 支付确认
1. 订单创建成功后
2. 选择支付方式（如"餐后付款"）
3. 点击确认支付按钮

**预期结果**：
- 支付确认成功提示
- 订单状态更新为"已支付"或"待支付"

**测试结果**：□ 通过 □ 失败

---

### 第4部分：数据持久化测试

#### 4.1 订单数据保存
1. 创建一个新订单
2. 调用订单列表API

**预期结果**：
- 新订单出现在订单列表中
- 订单数据完整（订单号、桌号、菜品、金额）

**测试结果**：□ 通过 □ 失败

#### 4.2 菜品库存更新
1. 查看某个菜品的库存（如"鱼香肉丝"）
2. 创建包含该菜品的订单
3. 再次查看该菜品的库存

**预期结果**：
- 菜品库存相应减少
- 减少数量 = 订单中的数量

**测试结果**：□ 通过 □ 失败

---

### 第5部分：错误处理测试

#### 5.1 无效桌号
```bash
curl -X POST http://127.0.0.1:8000/api/orders/ \
  -H "Content-Type: application/json" \
  -d '{
    "table_id": 99999,
    "items": [{"menu_item_id": 2, "quantity": 1}]
  }'
```
**预期结果**：
- 状态码：404
- 返回错误信息"桌号不存在"

**测试结果**：□ 通过 □ 失败

#### 5.2 无效菜品ID
```bash
curl -X POST http://127.0.0.1:8000/api/orders/ \
  -H "Content-Type: application/json" \
  -d '{
    "table_id": 55,
    "items": [{"menu_item_id": 99999, "quantity": 1}]
  }'
```
**预期结果**：
- 状态码：404
- 返回错误信息"菜品ID xxx 不存在"

**测试结果**：□ 通过 □ 失败

#### 5.3 库存不足（如实现了）
1. 创建订单时，菜品数量超过库存

**预期结果**：
- 返回库存不足错误
- 订单创建失败

**测试结果**：□ 通过 □ 失败

---

### 第6部分：并发测试

#### 6.1 多桌号同时下单
同时创建多个不同桌号的订单

**预期结果**：
- 所有订单都成功创建
- 订单数据互不干扰

**测试结果**：□ 通过 □ 失败

#### 6.2 同一桌号连续下单
在同一桌号连续创建多个订单

**预期结果**：
- 所有订单都成功创建
- 订单状态正确

**测试结果**：□ 通过 □ 失败

---

## 测试结果汇总

### 通过的测试项目数：____ / ____

### 失败的测试项目
1. ____________________
2. ____________________
3. ____________________

### 发现的问题
1. ____________________
2. ____________________
3. ____________________

### 备注
_________________________
_________________________
_________________________

---

## 下一步

如果所有测试都通过 ✅，则可以进行打包部署。
如果有测试失败 ❌，需要先修复问题，然后重新测试。

## 打包清单（测试通过后）

### 后端打包
- [ ] 启动脚本（start_backend.sh / start_backend.bat）
- [ ] 配置文件（.env 或 config.ini）
- [ ] 依赖文件（requirements.txt）
- [ ] 数据库初始化脚本

### 前端打包
- [ ] HTML文件（customer_order_v3_fixed.html）
- [ ] 部署说明文档
- [ ] Nginx/Apache 配置示例
- [ ] 访问地址说明

### 文档
- [ ] 安装部署文档
- [ ] 使用说明文档
- [ ] 常见问题FAQ

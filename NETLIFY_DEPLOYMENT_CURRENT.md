# é¤é¥®ç‚¹é¤ç³»ç»Ÿ - Netlify éƒ¨ç½²æŒ‡å—ï¼ˆå½“å‰ç¯å¢ƒï¼‰

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©æ‚¨å°†é¤é¥®ç‚¹é¤ç³»ç»Ÿçš„å‰ç«¯éƒ¨åˆ†éƒ¨ç½²åˆ° Netlifyï¼Œå¹¶ç¡®ä¿å‰åç«¯èƒ½å¤Ÿæ­£å¸¸é€šä¿¡ã€‚

**é‡è¦æç¤º**ï¼š
- âœ… å‰ç«¯ï¼šéƒ¨ç½²åˆ° Netlify
- âœ… åç«¯ï¼šè¿è¡Œåœ¨å½“å‰æ²™ç›’ç¯å¢ƒï¼ˆ115.191.1.219ï¼‰
- âš ï¸ éœ€è¦ç¡®ä¿åç«¯APIç«¯å£å¯¹å¤–å¼€æ”¾

---

## ğŸš€ å½“å‰ç¯å¢ƒä¿¡æ¯

### åç«¯æœåŠ¡çŠ¶æ€

| æœåŠ¡ | ç«¯å£ | çŠ¶æ€ | è®¿é—®åœ°å€ |
|------|------|------|----------|
| é¡¾å®¢ç«¯API | 8000 | âœ… è¿è¡Œä¸­ | http://115.191.1.219:8000 |
| åº—å‘˜ç«¯API | 8001 | âœ… è¿è¡Œä¸­ | http://115.191.1.219:8001 |
| ä¼šå‘˜API | 8004 | âœ… è¿è¡Œä¸­ | http://115.191.1.219:8004 |
| æ€»å…¬å¸API | 8006 | âœ… è¿è¡Œä¸­ | http://115.191.1.219:8006 |

### æ•°æ®åº“ä¿¡æ¯

- **æ•°æ®åº“ç±»å‹**: PostgreSQL 17.5
- **æ•°æ®åº“å**: Database_1767780824754
- **çŠ¶æ€**: âœ… è¿æ¥æ­£å¸¸

### Netlify é…ç½®

netlify.toml å·²é…ç½®ä¸ºå°†å‰ç«¯APIè¯·æ±‚ä»£ç†åˆ°åç«¯æœåŠ¡ï¼š
- APIåœ°å€ï¼š`http://115.191.1.219`
- æ”¯æŒçš„ç«¯å£ï¼š8000, 8001, 8004, 8006

---

## âš™ï¸ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šå‡†å¤‡å‰ç«¯æ–‡ä»¶

å‰ç«¯æ–‡ä»¶ä½äº `assets/` ç›®å½•ï¼ŒåŒ…å«ä»¥ä¸‹é¡µé¢ï¼š

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| portal.html | é—¨æˆ·å…¥å£é¡µé¢ |
| customer_order_v3.html | é¡¾å®¢ç‚¹é¤é¡µé¢ |
| staff_workflow.html | å·¥ä½œäººå‘˜ç«¯é¡µé¢ |
| login_standalone.html | ç™»å½•é¡µé¢ |
| member_center.html | ä¼šå‘˜ä¸­å¿ƒ |
| headquarters_dashboard.html | æ€»å…¬å¸åå° |
| menu_management.html | èœå“ç®¡ç† |
| shop_settings.html | åº—é“ºè®¾ç½® |
| settlement_management.html | ç»“ç®—ç®¡ç† |

### æ­¥éª¤ 2ï¼šéƒ¨ç½²åˆ° Netlify

**æ–¹æ³•Aï¼šæ‹–æ‹½éƒ¨ç½²ï¼ˆæœ€å¿«ï¼‰**

1. è®¿é—® https://app.netlify.com/drop
2. å°† `assets/` æ–‡ä»¶å¤¹æ‹–æ‹½åˆ°é¡µé¢
3. ç­‰å¾… 1-2 åˆ†é’Ÿï¼Œéƒ¨ç½²å®Œæˆ
4. è·å¾— Netlify åŸŸåï¼Œä¾‹å¦‚ï¼š`https://random-name-12345.netlify.app`

**æ–¹æ³•Bï¼šä½¿ç”¨ Netlify CLI**

```bash
# å®‰è£… Netlify CLIï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
npm install -g netlify-cli

# ç™»å½• Netlify
netlify login

# éƒ¨ç½²
cd /workspace/projects
netlify deploy --prod --dir=assets
```

**æ–¹æ³•Cï¼šGitHub é›†æˆï¼ˆæ¨èç”¨äºæŒç»­æ›´æ–°ï¼‰**

1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Netlify Dashboard å¯¼å…¥ GitHub ä»“åº“
3. é…ç½®ï¼š
   - Build command: `# No build command needed`
   - Publish directory: `assets`

### æ­¥éª¤ 3ï¼šé…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

åœ¨ Netlify Dashboard ä¸­ï¼š
1. ç‚¹å‡» "Domain settings"
2. ç‚¹å‡» "Add custom domain"
3. è¾“å…¥æ‚¨çš„åŸŸåï¼ˆä¾‹å¦‚ï¼šrestaurant.yourdomain.comï¼‰
4. é…ç½®DNSè§£æ
5. ç­‰å¾…HTTPSè¯ä¹¦è‡ªåŠ¨ç”Ÿæˆ

---

## âš ï¸ é‡è¦ï¼šç«¯å£å¼€æ”¾é…ç½®

ä¸ºäº†è®© Netlify å‰ç«¯èƒ½å¤Ÿè®¿é—®åç«¯APIï¼Œéœ€è¦ç¡®ä¿ä»¥ä¸‹ç«¯å£å¯¹å¤–å¼€æ”¾ï¼š

```bash
# æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ï¼ˆæ ¹æ®æ‚¨çš„ç³»ç»Ÿé€‰æ‹©ï¼‰
sudo ufw status  # Ubuntu/Debian
sudo firewall-cmd --list-all  # CentOS/RHEL

# å¼€æ”¾ç«¯å£
sudo ufw allow 8000/tcp  # é¡¾å®¢ç«¯API
sudo ufw allow 8001/tcp  # åº—å‘˜ç«¯API
sudo ufw allow 8004/tcp  # ä¼šå‘˜API
sudo ufw allow 8006/tcp  # æ€»å…¬å¸API
```

**å¦‚æœä½¿ç”¨äº‘æœåŠ¡å•†**ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€AWSç­‰ï¼‰ï¼š
1. ç™»å½•äº‘æœåŠ¡å•†æ§åˆ¶å°
2. è¿›å…¥å®‰å…¨ç»„/é˜²ç«å¢™è§„åˆ™
3. æ·»åŠ å…¥ç«™è§„åˆ™ï¼Œå¼€æ”¾ç«¯å£ 8000, 8001, 8004, 8006
4. åè®®ï¼šTCP
5. æ¥æºï¼š0.0.0.0/0ï¼ˆæˆ–é™åˆ¶ä¸º Netlify çš„IPæ®µï¼‰

---

## ğŸ§ª æµ‹è¯•éƒ¨ç½²

### 1. æµ‹è¯•åç«¯API

```bash
# æµ‹è¯•é¡¾å®¢ç«¯API
curl http://115.191.1.219:8000/

# æµ‹è¯•åº—å‘˜ç«¯API
curl http://115.191.1.219:8001/

# æµ‹è¯•ä¼šå‘˜API
curl http://115.191.1.219:8004/

# æµ‹è¯•æ€»å…¬å¸API
curl http://115.191.1.219:8006/
```

### 2. æµ‹è¯•å‰ç«¯è®¿é—®

è®¿é—®æ‚¨çš„ Netlify ç«™ç‚¹ï¼Œä¾‹å¦‚ï¼š
```
https://your-site-name.netlify.app
```

æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š
- [ ] é—¨æˆ·é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] ç‚¹å‡»"é¡¾å®¢ç‚¹é¤"è¿›å…¥ç‚¹é¤é¡µé¢
- [ ] å¯ä»¥é€‰æ‹©æ¡Œå·å¹¶æµè§ˆèœå•
- [ ] å·¥ä½œäººå‘˜å¯ä»¥ç™»å½•
- [ ] ä¼šå‘˜ä¸­å¿ƒå¯ä»¥è®¿é—®
- [ ] æ€»å…¬å¸åå°å¯ä»¥ç™»å½•

### 3. æ£€æŸ¥APIä»£ç†

åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ä¸­ï¼š
1. æ‰“å¼€ Network æ ‡ç­¾
2. åˆ·æ–°é¡µé¢
3. æŸ¥çœ‹APIè¯·æ±‚æ˜¯å¦æˆåŠŸ
4. æ£€æŸ¥æ˜¯å¦æœ‰è·¨åŸŸé”™è¯¯ï¼ˆCORSï¼‰

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šå‰ç«¯æ— æ³•è¿æ¥åç«¯

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºAPIè¯·æ±‚å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼š
   ```bash
   netstat -tlnp | grep -E ":(8000|8001|8004|8006)"
   ```
2. ç¡®è®¤ç«¯å£å·²å¯¹å¤–å¼€æ”¾ï¼š
   ```bash
   # ä»å¤–éƒ¨æµ‹è¯•
   curl http://115.191.1.219:8000/
   ```
3. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
4. æ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„è§„åˆ™

### é—®é¢˜2ï¼šCORS é”™è¯¯

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºè·¨åŸŸé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
åç«¯APIå·²é…ç½®CORSå…è®¸æ‰€æœ‰æ¥æºï¼Œå¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
```python
# åœ¨ api æ–‡ä»¶ä¸­ç¡®è®¤CORSé…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### é—®é¢˜3ï¼šWebSocket è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼šå®æ—¶é€šçŸ¥ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤WebSocketæœåŠ¡è¿è¡Œåœ¨ç«¯å£8001
2. æ£€æŸ¥WebSocketè¿æ¥é…ç½®ï¼š
   ```javascript
   const ws = new WebSocket('ws://115.191.1.219:8001/ws/table/8');
   ```
3. ç¡®è®¤é˜²ç«å¢™å…è®¸WebSocketè¿æ¥

### é—®é¢˜4ï¼šNetlify é‡å®šå‘é…ç½®é”™è¯¯

**ç—‡çŠ¶**ï¼š404 é”™è¯¯æˆ–é¡µé¢æ‰¾ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ `netlify.toml` æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•
2. ç¡®è®¤é…ç½®è¯­æ³•æ­£ç¡®
3. åœ¨ Netlify Dashboard çš„ "Site configuration" ä¸­æŸ¥çœ‹é‡å®šå‘è§„åˆ™

---

## ğŸ“š ç³»ç»Ÿè®¿é—®åœ°å€ï¼ˆéƒ¨ç½²åï¼‰

| é¡µé¢ | URL | è¯´æ˜ |
|------|-----|------|
| é—¨æˆ·é¦–é¡µ | `https://your-site.netlify.app/` | ç»Ÿä¸€å…¥å£ |
| é¡¾å®¢ç‚¹é¤ | `https://your-site.netlify.app/customer-order` | æ‰«ç ç‚¹é¤é¡µé¢ |
| å·¥ä½œäººå‘˜ç«¯ | `https://your-site.netlify.app/staff-workflow` | åº—é•¿/å¨å¸ˆ/ä¼ èœå‘˜/æ”¶é“¶å‘˜ |
| ä¼šå‘˜ä¸­å¿ƒ | `https://your-site.netlify.app/member-center` | ä¼šå‘˜ç§¯åˆ†å’Œè®¢å• |
| æ€»å…¬å¸åå° | `https://your-site.netlify.app/headquarters` | è¥æ”¶å’Œäººå‘˜ç®¡ç† |
| èœå“ç®¡ç† | `https://your-site.netlify.app/menu-management` | èœå“å¢åˆ æ”¹æŸ¥ |
| åº—é“ºè®¾ç½® | `https://your-site.netlify.app/shop-settings` | æ¡Œå·å’ŒäºŒç»´ç ç”Ÿæˆ |

---

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### æ›´æ–°å‰ç«¯æ–‡ä»¶

**æ–¹æ³•Aï¼šæ‹–æ‹½éƒ¨ç½²**
```bash
# é‡æ–°æ‰“åŒ… assets æ–‡ä»¶å¤¹
cd /workspace/projects
zip -r restaurant-system.zip assets/ netlify.toml
```
ç„¶ååœ¨ Netlify Dashboard ä¸Šé‡æ–°ä¸Šä¼ 

**æ–¹æ³•Bï¼šNetlify CLI**
```bash
cd /workspace/projects
netlify deploy --prod --dir=assets
```

**æ–¹æ³•Cï¼šGit é›†æˆ**
```bash
git add assets/
git commit -m "Update frontend files"
git push origin main
```

### æ›´æ–°åç«¯API

```bash
# å¦‚æœä¿®æ”¹äº†åç«¯ä»£ç ï¼Œéœ€è¦é‡å¯æœåŠ¡
# æ‰¾åˆ°è¿›ç¨‹ID
ps aux | grep uvicorn

# é‡å¯æœåŠ¡
pkill -f "uvicorn.*8000"
pkill -f "uvicorn.*8001"
pkill -f "uvicorn.*8004"
pkill -f "uvicorn.*8006"

# é‡æ–°å¯åŠ¨
python scripts/start_api_services.py &
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### Netlify é…ç½®ä¼˜åŒ–

netlify.toml å·²åŒ…å«ä»¥ä¸‹ä¼˜åŒ–ï¼š

```toml
[build.processing]
  css.minify = false
  js.minify = false
  images.compress = true

[[headers]]
  for = "/*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
```

### å»ºè®®çš„è¿›ä¸€æ­¥ä¼˜åŒ–

1. **å¯ç”¨ CDN åŠ é€Ÿ**ï¼šNetlify è‡ªåŠ¨æä¾›å…¨çƒCDN
2. **å‹ç¼©å›¾ç‰‡**ï¼šä½¿ç”¨å·¥å…·å‹ç¼© assets/ ç›®å½•ä¸­çš„å›¾ç‰‡
3. **å¯ç”¨ Gzip/Brotli**ï¼šNetlify é»˜è®¤å¯ç”¨
4. **ä½¿ç”¨é¢„åŠ è½½**ï¼šåœ¨ HTML ä¸­æ·»åŠ  `<link rel="preload">`

---

## ğŸ” å®‰å…¨å»ºè®®

1. **é™åˆ¶ API è®¿é—®æ¥æº**
   ```python
   # åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé™åˆ¶CORSæ¥æº
   allow_origins=["https://your-site.netlify.app"]
   ```

2. **å¯ç”¨ HTTPS**
   - Netlify è‡ªåŠ¨æä¾› HTTPS
   - åç«¯APIå»ºè®®ä½¿ç”¨ Nginx åå‘ä»£ç† + SSL

3. **API å¯†é’¥ç®¡ç†**
   - ä¸è¦åœ¨å‰ç«¯ä»£ç ä¸­æš´éœ²æ•æ„Ÿå¯†é’¥
   - ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨é…ç½®

4. **å®šæœŸå¤‡ä»½æ•°æ®åº“**
   ```bash
   # å¤‡ä»½æ•°æ®åº“
   pg_dump -h $PGHOST -U $PGUSER $PGDATABASE > backup.sql
   ```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ Netlify éƒ¨ç½²æ—¥å¿—ï¼šNetlify Dashboard â†’ Deploys
2. æ£€æŸ¥åç«¯æœåŠ¡æ—¥å¿—ï¼š
   ```bash
   journalctl -u restaurant-* -f
   ```
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
4. å‚è€ƒ [USER_MANUAL.md](USER_MANUAL.md) äº†è§£ç³»ç»Ÿä½¿ç”¨æ–¹æ³•

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] åç«¯APIæœåŠ¡æ­£å¸¸è¿è¡Œï¼ˆ8000, 8001, 8004, 8006ï¼‰
- [ ] ç«¯å£å·²å¯¹å¤–å¼€æ”¾ï¼ˆé˜²ç«å¢™/å®‰å…¨ç»„ï¼‰
- [ ] å‰ç«¯æ–‡ä»¶å·²éƒ¨ç½²åˆ°Netlify
- [ ] netlify.toml é…ç½®æ­£ç¡®
- [ ] APIä»£ç†é…ç½®æ­£ç¡®ï¼ˆ115.191.1.219ï¼‰
- [ ] æµ‹è¯•å‰ç«¯åˆ°åç«¯è¿æ¥
- [ ] æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æ¨¡å—
- [ ] é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰
- [ ] å¯ç”¨HTTPSï¼ˆNetlifyè‡ªåŠ¨æä¾›ï¼‰
- [ ] é…ç½®æ•°æ®åº“å¤‡ä»½è®¡åˆ’

---

**ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰

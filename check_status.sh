#!/bin/bash

###############################################################################
# 检查当前系统状态并更新部署
###############################################################################

echo "========================================="
echo "  检查当前系统状态"
echo "========================================="
echo ""

# 检查当前目录
echo "[1] 当前目录："
pwd
echo ""

# 检查是否有项目文件
echo "[2] 检查项目文件："
ls -la | head -20
echo ""

# 检查 Git 状态
if [ -d ".git" ]; then
    echo "[3] Git 状态："
    git remote -v
    echo ""
    git log --oneline -3
    echo ""
else
    echo "[3] 不是 Git 仓库"
    echo ""
fi

# 检查服务状态
echo "[4] 服务状态："
systemctl status restaurant 2>/dev/null | grep -E "(Active:|Loaded:)" || echo "服务未安装"
echo ""

# 检查端口
echo "[5] 端口监听："
netstat -tlnp 2>/dev/null | grep :8000 || echo "端口 8000 未监听"
echo ""

echo "========================================="
echo "  状态检查完成"
echo "========================================="

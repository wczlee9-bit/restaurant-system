# 多店铺扫码点餐系统 - 完整测试平台

## 📋 概述

这是一个功能完整的网页版测试系统，支持前台顾客端和后台管理的全流程测试。

## 🚀 快速开始

### 1. 启动后端服务

```bash
# 在终端中运行
cd /workspace/projects
python -m uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

### 2. 打开测试系统

在浏览器中打开以下文件：
```
assets/restaurant_test_system.html
```

## 📱 功能模块

### 1. 顾客端 (扫码点餐)

**功能说明：**
- 选择桌号：显示所有可用桌号，点击选择
- 选菜：浏览菜品，按分类筛选，加入购物车
- 购物车：查看已选菜品，调整数量
- 支付：选择支付方式（微信/支付宝/信用卡/借记卡/现金），输入会员手机号（可选）

**测试流程：**
1. 点击任意空闲桌号
2. 浏览菜品，点击"加入购物车"
3. 点击"去结算"查看购物车
4. 点击"去结算"进入支付页面
5. 选择支付方式，点击"确认支付并下单"
6. 查看订单详情通知

### 2. 订单管理

**功能说明：**
- 查看所有订单，支持按状态和桌号筛选
- 查看订单详情
- 更新订单状态（待确认→已确认→制作中→待传菜→上菜中→已完成）
- 打印订单小票

**订单状态流转规则：**
```
pending (待确认) → confirmed (已确认) → preparing (制作中) 
    → ready (待传菜) → serving (上菜中) → completed (已完成)
                            ↓
                      cancelled (已取消)
```

**测试流程：**
1. 在"订单管理"标签查看新订单
2. 点击"详情"查看订单信息
3. 点击相应按钮更新订单状态
4. 点击"打印"查看并打印小票

### 3. 厨房制作

**功能说明：**
- 查看待制作订单（已确认、制作中、待传菜状态）
- 更新单个菜品状态（开始制作/制作完成）
- 打印厨房制作单

**测试流程：**
1. 切换到"厨房制作"标签
2. 查看所有待制作订单
3. 对每个菜品点击"开始制作"
4. 制作完成后点击"制作完成"
5. 点击"打印制作单"打印制作小票

### 4. 传菜管理

**功能说明：**
- 查看待传菜订单（待传菜、上菜中状态）
- 打印传菜单
- **逐一确认上菜**（在顾客面前确认）
- 全部上菜完成后自动完成订单

**测试流程：**
1. 切换到"传菜管理"标签
2. 查看待传菜订单
3. 点击"打印传菜单"打印传菜小票
4. **重要**：上菜员在顾客面前，每上一道菜，点击对应的"确认上菜"按钮
5. 已上菜的菜品会显示删除线
6. 全部上完后点击"全部上菜完成"

### 5. 菜品管理

**功能说明：**
- 查看所有菜品
- 添加新菜品
- 编辑菜品信息（名称、价格、库存、描述等）
- 删除菜品
- 设置推荐菜品
- 上下架管理

**测试流程：**
1. 切换到"菜品管理"标签
2. 点击"添加菜品"创建测试菜品
3. 点击"编辑"修改菜品信息
4. 点击"删除"删除不需要的菜品

### 6. 桌号管理

**功能说明：**
- 查看所有桌号
- 添加新桌号
- 编辑桌号信息（桌号、座位数、状态）
- 删除桌号
- 生成桌号二维码（用于顾客扫码点餐）

**测试流程：**
1. 切换到"桌号管理"标签
2. 点击"生成二维码"查看桌号二维码
3. 点击"编辑"修改桌号信息
4. 点击"添加桌号"创建新桌号

### 7. 系统设置

**功能说明：**
- 修改店铺名称、地址、电话
- 修改API地址

## 🔄 全流程测试用例

### 测试用例1：完整下单流程

**步骤：**
1. **顾客端**：选择桌号1
2. **顾客端**：添加宫保鸡丁、白米饭到购物车
3. **顾客端**：结算，选择微信支付，输入会员手机号13800138000
4. **订单管理**：查看订单，确认订单状态为pending
5. **订单管理**：点击"确认订单"，状态变为confirmed
6. **厨房制作**：查看订单，点击"开始制作"
7. **厨房制作**：制作完成后点击"制作完成"
8. **传菜管理**：点击"打印传菜单"
9. **传菜管理**：逐一确认上菜（每上一道菜点击"确认上菜"）
10. **传菜管理**：点击"全部上菜完成"
11. **订单管理**：验证订单状态为completed
12. **订单管理**：点击"打印"打印最终订单小票

**预期结果：**
- 订单状态正确流转
- 会员积分增加（消费金额=积分）
- 小票内容正确
- 菜品状态正确更新

### 测试用例2：多种支付方式

**步骤：**
1. 创建多个订单，分别使用：
   - 微信支付
   - 支付宝
   - 信用卡
   - 借记卡
   - 现金
2. 查看订单详情，验证支付方式显示正确
3. 打印小票，验证支付方式显示正确

### 测试用例3：菜品管理

**步骤：**
1. 添加新菜品"鱼香肉丝"，价格32元，分类为热菜
2. 设置为推荐菜品
3. 设置库存为50
4. 刷新顾客端，验证新菜品显示
5. 下单购买新菜品
6. 验证库存减少

### 测试用例4：多订单并发测试

**步骤：**
1. 同时在多个桌号下单（桌号1、2、3）
2. 验证所有订单都正确创建
3. 在厨房制作页面同时处理多个订单
4. 验证状态更新互不影响

## 🖨️ 小票打印说明

### 订单小票
包含以下信息：
- 店铺名称、地址、电话
- 订单号、桌号、时间
- 支付方式
- 订单明细（菜品、数量、价格）
- 总金额

### 传菜单小票
包含以下信息：
- 桌号、订单号
- 待传菜品列表
- 上菜确认说明

### 打印方法
1. 点击"打印"或"打印传菜单"按钮
2. 在弹出的预览窗口中查看小票内容
3. 点击"打印"按钮，会调用浏览器打印功能
4. 选择小票打印机进行打印

## 📊 修改建议和优化方向

### 当前系统特点
✅ **优点：**
- 功能完整，覆盖全流程
- 界面清晰，操作简单
- 实时状态更新
- 支持多种支付方式
- 小票打印功能完善

### 可以改进的地方
🔧 **建议优化：**

1. **WebSocket实时通信**
   - 当前需要手动刷新查看最新订单
   - 建议添加WebSocket实现订单状态实时推送
   - 厨房、传菜、前台自动同步最新状态

2. **会员积分显示**
   - 支付成功后显示获得积分
   - 显示会员等级和折扣优惠
   - 提供积分查询页面

3. **订单备注功能**
   - 允许顾客添加订单备注（如少辣、不要香菜等）
   - 备注在小票和制作单中显示

4. **库存预警**
   - 库存低于阈值时提示
   - 自动下架库存为0的菜品

5. **语音播报**
   - 新订单到来时语音提示
   - 订单状态变更时语音提示

6. **报表统计**
   - 添加营收统计页面
   - 菜品销量排行
   - 高峰时段分析

7. **用户体验优化**
   - 添加加载动画
   - 优化移动端适配
   - 添加错误提示和重试机制

8. **传菜流程优化**
   - 添加上菜超时提醒
   - 支持批量确认上菜
   - 添加传菜员指派功能

## 🐛 已知问题和限制

1. **API连接**
   - 默认API地址为 http://localhost:8000
   - 如果后端服务未启动，所有功能将无法使用
   - 可在"系统设置"中修改API地址

2. **图片显示**
   - 菜品图片URL可能无法访问
   - 使用了占位图替代

3. **打印功能**
   - 依赖浏览器打印功能
   - 需要正确配置小票打印机

4. **数据持久化**
   - 所有数据保存在数据库中
   - 刷新页面不会丢失数据

## 📞 技术支持

如有问题，请检查：
1. 后端服务是否正常运行
2. API地址配置是否正确
3. 数据库连接是否正常
4. 浏览器控制台是否有错误信息

---

**最后更新时间：** 2024年
**测试系统版本：** 1.0.0

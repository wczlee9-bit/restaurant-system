# 🔐 登录功能测试指南

## ✅ 已完成的功能

### 1. 中英文双语登录页面
- 文件位置：`assets/login.html`
- 功能特性：
  - ✅ 中英文语言切换
  - ✅ 用户名和密码输入
  - ✅ 演示账号快速填写
  - ✅ 自动检测 API 地址
  - ✅ 本地和 API 双重验证
  - ✅ 登录成功后跳转
  - ✅ 登录失败提示

### 2. 主页面更新
- 文件位置：`assets/index.html`
- 更新内容：
  - ✅ 添加"工作人员登录"按钮
  - ✅ 按钮位置：快速操作区域

### 3. 工作人员端更新
- 文件位置：`assets/staff_workflow.html`
- 更新内容：
  - ✅ 登录状态验证（未登录自动跳转到登录页）
  - ✅ 当前用户显示
  - ✅ 退出登录按钮
  - ✅ 中英文双语提示

---

## 🧪 测试步骤

### 步骤 1：访问登录页面

打开浏览器，访问：
```
http://localhost:8080/assets/login.html
```

或从主页面点击"🔐 工作人员登录"按钮

### 步骤 2：测试语言切换

1. 页面右上角有两个语言按钮：**中文** 和 **EN**
2. 点击"中文"，页面显示中文文本
3. 点击"EN"，页面显示英文文本
4. 检查所有文本是否正确切换：
   - 标题："扫码点餐系统" / "Restaurant POS System"
   - 标签：用户名/密码标签
   - 按钮：登录/演示账号

### 步骤 3：测试登录

#### 方式一：手动输入

1. 用户名：`admin`
2. 密码：`admin123`
3. 点击"登录"按钮
4. 验证：
   - ✅ 显示"登录成功 / Login successful"提示
   - ✅ 自动跳转到 `staff_workflow.html`

#### 方式二：使用演示账号

在页面下方有6个演示账号卡片：

| 角色 | 图标 | 用户名 | 密码 |
|------|------|--------|------|
| 系统管理员 | 👑 | system_admin | admin123 |
| 总公司 | 🏢 | company | company123 |
| 店长 | 👔 | admin | admin123 |
| 厨师 | 👨‍🍳 | chef | chef123 |
| 传菜员 | 🤵 | waiter | waiter123 |
| 收银员 | 💰 | cashier | cashier123 |

1. 点击任意一个演示账号卡片
2. 用户名和密码会自动填充
3. 点击"登录"按钮
4. 验证跳转成功

### 步骤 4：测试登录验证

#### 测试未登录访问工作人员端

1. 清除浏览器缓存或使用无痕模式
2. 直接访问：`http://localhost:8080/assets/staff_workflow.html`
3. 验证：
   - ✅ 显示"请先登录 / Please login first"提示
   - ✅ 1秒后自动跳转到 `login.html`

#### 测试已登录访问工作人员端

1. 先登录成功
2. 访问 `staff_workflow.html`
3. 验证：
   - ✅ 页面正常加载
   - ✅ 右上角显示"当前用户: [用户名]"
   - ✅ 可以正常使用工作人员端功能

### 步骤 5：测试退出登录

1. 登录工作人员端
2. 点击右上角的"🚪 退出"按钮
3. 确认退出对话框：
   - 中文："确定要退出登录吗？"
   - 英文："Are you sure you want to logout?"
4. 点击"确定 / Yes"
5. 验证：
   - ✅ 显示"退出成功 / Logout successful"提示
   - ✅ 自动跳转到 `login.html`

### 步骤 6：测试错误处理

#### 测试空输入

1. 不输入用户名和密码
2. 点击"登录"
3. 验证：
   - ✅ 显示错误提示："用户名和密码不能为空"

#### 测试错误密码

1. 用户名：`admin`
2. 密码：`wrongpassword`
3. 点击"登录"
4. 验证：
   - ✅ 显示"用户名或密码错误 / Invalid username or password"

---

## 📱 演示账号列表

### 系统管理员 (System Admin)
- **用户名**: `system_admin`
- **密码**: `admin123`
- **权限**: 系统最高权限，可以管理所有店铺、所有用户和系统设置

### 总公司 (Company HQ)
- **用户名**: `company`
- **密码**: `company123`
- **权限**: 可以查看所有店铺的营收数据，进行统计分析和决策

### 店长 (Manager)
- **用户名**: `admin`
- **密码**: `admin123`
- **权限**: 查看所有订单、统计数据、管理权限

### 厨师 (Chef)
- **用户名**: `chef`
- **密码**: `chef123`
- **权限**: 处理待制作订单、更新菜品状态

### 传菜员 (Waiter)
- **用户名**: `waiter`
- **密码**: `waiter123`
- **权限**: 处理待传菜订单、确认上菜

### 收银员 (Cashier)
- **用户名**: `cashier`
- **密码**: `cashier123`
- **权限**: 处理待支付订单、确认收款

---

## 🔍 功能说明

### 语言设置持久化

- 用户选择的语言会保存在 `localStorage` 中
- 下次访问时自动加载上次选择的语言

### 登录状态管理

- 登录成功后，用户信息保存在 `localStorage` 中
- 包含：用户名、角色、登录时间、Token（如果有）
- 退出登录时清除登录信息

### API 地址自动检测

系统会自动检测运行环境：
- **Netlify 环境**：使用云端 API
- **本地环境**：使用 localhost:8000
- **默认回退**：使用 localhost:8000

### 验证逻辑

1. **优先本地验证**：从 `config/users.json` 读取用户数据
2. **备用 API 验证**：调用 `/api/auth/login` 接口
3. **演示账号**：内置4个演示账号，方便测试

---

## 🐛 常见问题

### Q1: 点击登录后没有反应？

**解决方法**：
1. 按 `F12` 打开浏览器控制台
2. 查看 Console 标签是否有错误
3. 查看 Network 标签检查 API 请求

### Q2: 登录成功后没有跳转？

**解决方法**：
1. 检查浏览器控制台是否有错误
2. 检查 `staff_workflow.html` 文件是否存在
3. 确认文件路径是否正确

### Q3: 退出登录后还能访问工作人员端？

**解决方法**：
1. 清除浏览器缓存
2. 刷新页面
3. 系统会重新检查登录状态

### Q4: 语言切换不生效？

**解决方法**：
1. 检查浏览器是否允许 localStorage
2. 清除浏览器缓存后重试
3. 按 `Ctrl + Shift + R` 强制刷新

---

## 📊 测试清单

### 基础功能
- [ ] 页面正常加载
- [ ] 语言切换正常工作
- [ ] 用户名密码输入正常
- [ ] 登录按钮正常工作
- [ ] 演示账号点击正常

### 登录功能
- [ ] 正确账号登录成功
- [ ] 错误密码显示错误
- [ ] 空输入显示错误
- [ ] 登录成功后自动跳转

### 验证功能
- [ ] 未登录访问被阻止
- [ ] 未登录自动跳转到登录页
- [ ] 已登录可以访问
- [ ] 当前用户信息显示正确

### 退出功能
- [ ] 退出按钮显示正常
- [ ] 退出确认对话框正常
- [ ] 退出后清除登录信息
- [ ] 退出后跳转到登录页

### 界面显示
- [ ] 中文文本正确
- [ ] 英文文本正确
- [ ] 响应式布局正常
- [ ] 移动端显示正常

---

## 🎯 测试完成后

如果所有功能都正常，说明登录功能已经完成！

**下一步**：
1. 可以将项目部署到 Netlify
2. 分享给其他人测试
3. 根据反馈继续优化

如果发现问题：
1. 记录问题详情
2. 查看浏览器控制台错误
3. 联系开发人员修复

---

## 💡 提示

- 测试时建议使用 Chrome 或 Edge 浏览器
- 可以使用浏览器开发者工具查看网络请求
- 清除缓存可以避免缓存问题
- 演示账号方便快速测试，不要修改密码

---

**祝测试顺利！** 🚀
